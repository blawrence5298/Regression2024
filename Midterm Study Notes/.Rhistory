airfares <- read.table("airfares.txt",header=TRUE)
attach(airfares)
#R output on page 104
m1 <- lm(Fare~Distance)
summary(m1)
#Figure 3.41 on page 104
par(mfrow=c(1,2))
plot(Distance,Fare)
abline(lsfit(Distance,Fare))
leverage1 <- hatvalues(m1)
StanRes1 <- rstandard(m1)
residual1 <- m1$residuals
plot(Distance,StanRes1, ylab="Standardized Residuals")
abline(h=2,lty=2)
abline(h=-2,lty=2)
qqnorm(StanRes1)
StanRes1Square <- (StanRes1)^2
plot(Distance,StanRes1Square, ylab="Squares of Standardized Residuals")
StanRes1Square <- sqrt(StanRes1)
plot(Distance,StanRes1Square, ylab="Square Roots of Standardized Residuals")
Fare_sqrt = sqrt(Fare)
plot(Distance,Fare_sqrt)
Fare_sqrt = sqrt(Fare)
plot(Distance,Fare_sqrt)
lm2 = lm(Fare_sqrt ~ Distance)
summary(lm2)
Fare_sqrt = sqrt(Fare)
plot(Distance,Fare_sqrt)
lm2 = lm(Fare_sqrt ~ Distance)
summary(lm2)
histogram(rstandard(lm2))
Fare_sqrt = sqrt(Fare)
plot(Distance,Fare_sqrt)
lm2 = lm(Fare_sqrt ~ Distance)
summary(lm2)
qqnorm(rstandard(lm2))
Fare_log= log(Fare)
plot(Distance,Fare_log)
lm2 = lm(Fare_log ~ Distance)
summary(lm2)
qqnorm(rstandard(lm2))
qt(-2.699,48)
pt(-2.699,48)
2*pt(-2.699,48)
2.2606/0.0981
confint(23.04383)
lower = 2.2606 - qt(0.975,48) * 0.0981
upper = 2.2606 + qt(0.975,48) * 0.0981
cat(lower,upper,"/n")
lower = 2.2606 - qt(0.975,48) * 0.0981
upper = 2.2606 + qt(0.975,48) * 0.0981
cat(lower,upper,"\n")
profsalary <- read.table("profsalary.txt", header=TRUE)
head(profsalary)
lm1 <- lm(Salary ~ Experience, data=profsalary)
lm1 <- lm(Salary ~ Experience, data=profsalary)
plot(Salary ~ Expereince, data=profsalary, ylab="Salary", xlab="Years of Experience")
lm1 <- lm(Salary ~ Experience, data=profsalary)
plot(Salary ~ Experience, data=profsalary, ylab="Salary", xlab="Years of Experience")
abline(lm1)
lm2 <- lm(Salary ~ Experience + I(Experience^2), data=profsalary)
summary(lm2)
plot(profsalary$Experience,resid(lm2), xlab="Years of Experience", ylab="Residuals")
range(profsalary$Experience)
x_grd <- seq(1, 36, by=0.5)
x_new <- data.frame(Experience = x_grd)
preds <- predict(lm2, newdata = x_new)
plot(Salary ~ Experience, data=profsalary, ylab="Salary", xlab="Years of Experience")
lines(x_grd, preds, col="blue", lwd=2.5)
curve(34.72+2.872*x-0.053*x^2, 1, 36, add=T)
plot(Salary ~ Experience, data=profsalary, ylab="Salary", xlab="Years of Experience")
curve(34.72+2.872*x-0.053*x^2, 1, 36, add=T)
library(ggplot2)
ggplot(data=profsalary, aes(Experience, Salary)) +
geom_point() +
stat_smooth(method='lm',formula = y ~ poly(x, 2))
resids1 <- sresid(lm1)
resids1 <- rstandard(lm1)
resids1 <- rstandard(lm1)
histogram(resids1)
resids1 <- rstandard(lm1)
hist(resids1)
resids2 <- rstandard(lm2)
hist(resids2)
