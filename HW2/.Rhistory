UN11 = read.csv("UN11.csv")
UN11 = read.csv("UN11.csv")
head(UN11)
plot(UN11$ppgdp,UN11$fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
fertility = UN11$fertility
ppgdp = UN11$ppgdp
plot(ppgdp,fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
plot(UN11$ppgdp,UN11$fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
model_1 = lm(fertility ~ ppgdp, data=UN11)
plot(UN11$ppgdp,UN11$fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
model_1 = lm(fertility ~ ppgdp, data=UN11)
abline(model_1, col="red")
UN11$log(fertility) = log10(UN11$fertility)
UN11$log_fertility = log10(UN11$fertility)  # Correct way to create a log column for fertility
UN11$log_ppgdp = log10(UN11$ppgdp)  # Correct way to create a log column for ppgdp
# Now, let's plot it correctly
plot(UN11$log_ppgdp, UN11$log_fertility, main="Fertility vs. GDP Per Person", xlab="Log(GDP Per Person)", ylab="Log(Total Fertility Rate)")
model_1 = lm(fertility ~ ppgdp, data=UN11)
abline(model_1, col="red")
UN11$log_fertility = log10(UN11$fertility)
UN11$log_ppgdp = log10(UN11$ppgdp)
plot(UN11$log_ppgdp, UN11$log_fertility, main="Fertility vs. GDP Per Person", xlab="Log(GDP Per Person)", ylab="Log(Total Fertility Rate)")
model_1 = lm(log_fertility ~ log_ppgdp, data=UN11)
abline(model_1, col="red")
summary(model_1)
Housing = read.csv("housing.csv")
head(Housing)
#plot the housing sale price vs. the square footage
Price = Housing$SalePrice
# Above grade (ground) living area square feet
Area = Housing$GrLivArea
plot(Price,Area,main="House Sale Price vs. Living Area Square Footage",xlab="Square Feet",ylab="Dollars")
#plot the housing sale price vs. the square footage
Price = Housing$SalePrice
# Above grade (ground) living area square feet
Area = Housing$GrLivArea
lm1 = lm(Price ~ Area, data=Housing)
plot(Price,Area,main="House Sale Price vs. Living Area Square Footage",xlab="Square Feet",ylab="Dollars")
abline(lm1)
#plot the housing sale price vs. the square footage
Price = Housing$SalePrice
# Above grade (ground) living area square feet
Area = Housing$GrLivArea
lm1 = lm(Price ~ Area, data=Housing)
plot(Price,Area,main="House Sale Price vs. Living Area Square Footage",xlab="Square Feet",ylab="Dollars")
abline(lm1,col="red")
# Assuming 'Housing' is your dataframe with the data
# Extracting the variables
Price = Housing$SalePrice
Area = Housing$GrLivArea
# Creating the linear model
lm1 = lm(Price ~ Area, data=Housing)
# Plotting the data
plot(Area, Price, main="House Sale Price vs. Living Area Square Footage", xlab="Square Feet", ylab="Dollars", col="blue")
# Adding the regression line
abline(lm1, col="red")
# Assuming 'Housing' is your dataframe with the data
# Extracting the variables
Price = Housing$SalePrice
Area = Housing$GrLivArea
# Creating the linear model
lm1 = lm(Price ~ Area, data=Housing)
# Plotting the data
plot(Area, Price, main="House Sale Price vs. Living Area Square Footage", xlab="Square Feet", ylab="Dollars", col="blue")
# Adding the regression line
abline(lm1, col="red")
# Assuming 'Housing' is your dataframe with the data
# Extracting the variables
Price = Housing$SalePrice
Area = Housing$GrLivArea
# Creating the linear model
lm1 = lm(Price ~ Area, data=Housing)
# Plotting the data
plot(Area, Price, main="House Sale Price vs. Living Area Square Footage", xlab="Square Feet", ylab="Dollars")
# Adding the regression line
abline(lm1, col="red")
# Calculate the fitted values from the model
fitted_values <- fitted(lm1)
# Calculate the residuals from the model
residuals <- resid(lm1)
# Plot the residuals against the fitted values
plot(fitted_values, residuals, main="Residuals vs. Fitted Values", xlab="Fitted Values", ylab="Residuals", col="darkgreen")
# Adding a horizontal line at 0 to help assess the dispersion
abline(h=0, col="red")
UN11 = read.csv("UN11.csv")
head(UN11)
# Calculate the fitted values from the model
fitted_values <- fitted(lm1)
# Calculate the residuals from the model
residuals <- resid(lm1)
# Plot the residuals against the fitted values
plot(fitted_values, residuals, main="Residuals vs. Fitted Values", xlab="Fitted Values", ylab="Residuals", col="darkgreen")
# Adding a horizontal line at 0 to help assess the dispersion
abline(h=0, col="red")
UN11 = read.csv("UN11.csv")
head(UN11)
# Calculate the fitted values from the model
fitted_values <- fitted(lm1)
# Calculate the residuals from the model
residuals <- resid(lm1)
# Plot the residuals against the fitted values
plot(fitted_values, residuals, main="Residuals vs. Fitted Values", xlab="Fitted Values", ylab="Residuals")
# Adding a horizontal line at 0 to help assess the dispersion
abline(h=0, col="red")
# Log transforming the variables
log_Price = log(Housing$SalePrice)
log_Area = log(Housing$GrLivArea)
# Creating the new linear model with the log-transformed variables
lm2 = lm(log_Price ~ log_Area, data=Housing)
# Calculate the fitted values and residuals for the new model
fitted_values_log = fitted(lm2)
residuals_log = resid(lm2)
# Plotting the residuals against the fitted values for the log-transformed model
plot(fitted_values_log, residuals_log, main="Residuals vs. Fitted Values (Log Transformed)", xlab="Fitted Values (Log)", ylab="Residuals (Log)")
# Adding a horizontal line at 0 to help assess the dispersion
abline(h=0, col="red")
# Log transforming the variables
log_Price = log(Housing$SalePrice)
log_Area = log(Housing$GrLivArea)
lm2 = lm(log_Price ~ log_Area, data=Housing)
# Log transforming the variables
log_Price = log(Housing$SalePrice)
log_Area = log(Housing$GrLivArea)
lm2 = lm(log_Price ~ log_Area, data=Housing)
plot(log_Price, log_Area)
abline(lm2, col="red")
# Log transforming the variables
log_Price = log(Housing$SalePrice)
log_Area = log(Housing$GrLivArea)
lm2 = lm(log_Price ~ log_Area, data=Housing)
plot(log_Area, log_Price)
abline(lm2, col="red")
lm3 = lm(log_Price ~ Area, data=Housing)
plot(Area, log_Price)
abline(lm2, col="red")
lm3 = lm(log_Price ~ Area, data=Housing)
plot(Area, log_Price)
abline(lm2, col="red")
summary(lm3)
# Log transforming the variables
log_Price = log(Housing$SalePrice)
log_Area = log(Housing$GrLivArea)
lm2 = lm(log_Price ~ log_Area, data=Housing)
plot(log_Area, log_Price)
abline(lm2, col="red")
summary(lm2)
# Assuming 'Housing' is your dataframe with the data
# Extracting the variables
Price = Housing$SalePrice
Area = Housing$GrLivArea
# Creating the linear model
lm1 = lm(Price ~ Area, data=Housing)
# Plotting the data
plot(Area, Price, main="House Sale Price vs. Living Area Square Footage", xlab="Square Feet", ylab="Dollars")
# Adding the regression line
abline(lm1, col="red")
summary(lm1)
Cars = read.csv("used_cars.csv")
head(Cars)
plot(Price,Year)
Cars = read.csv("used_cars.csv")
Price = Cars$price
Year = Cars$model_year
head(Cars)
plot(Price,Year)
Cars = read.csv("used_cars.csv")
Price <- as.numeric(gsub("\\$", "", Cars$price))
Year = Cars$model_year
head(Cars)
Cars = read.csv("used_cars.csv")
Price <- as.numeric(gsub("\\$", "", Cars$price))
Year = Cars$model_year
head(Cars)
head(Price)
Cars = read.csv("used_cars.csv")
Price <- as.numeric(gsub("\\$", "", Cars$price))
Year = Cars$model_year
head(Cars)
plot(Price,Year)
Cars = read.csv("used_cars.csv")
Cars$PriceNumeric <- as.integer(gsub("\\$|,", "", Cars$Price))
Cars = read.csv("used_cars.csv")
Cars$PriceNumeric <- as.numeric(gsub("\\$|,", "", Cars$Price))
Cars = read.csv("used_cars.csv")
head(Cars)
Cars = read.csv("used_cars.csv")
head(Cars)
Cars = read.csv("used_cars.csv")
Cars$clean_price <- as.integer(gsub("[\\$,]", "", Cars$price))
head(Cars)
Price = Cars$clean_price
Year = Cars$model_year
plot(Price,Year)
Price = Cars$clean_price
Year = Cars$model_year
plot(Year,Price)
Price = Cars$clean_price
Year = Cars$model_year
log_price = log(Price)
log_year = log(Year)
plot(Year,Price)
plot(log_year,log_price)
Price = Cars$clean_price
Year = Cars$model_year
log_price = log(Price)
log_year = log(Year)
plot(Year,Price)
plot(log_year,log_price)
plot(year,log_price)
Price = Cars$clean_price
Year = Cars$model_year
log_price = log(Price)
log_year = log(Year)
plot(Year,Price)
plot(log_year,log_price)
plot(Year,log_price)
lm1 = lm(Price ~ Year, data=Cars)
lm2 = lm(log_price ~ Year, data=Cars)
lm3 = lm(log_price ~ log_year, data=Cars)
lm1 = lm(Price ~ Year, data=Cars)
lm2 = lm(log_price ~ Year, data=Cars)
lm3 = lm(log_price ~ log_year, data=Cars)
summary(lm1)
summary(lm2)
summary(lm3)
Cars = read.csv(used_cars_updated.csv)
Cars = read.csv(used_cars_updated.csv)
Cars = read.csv("used_cars_updated.csv")
head(Cars)
Year = Cars$model_year
Price = Cars$clean_price
lm1 = lm(Price ~ Year, data=Cars)
Cars = read.csv("used_cars_updated.csv")
head(Cars)
Year = Cars$model_year
Price = Cars$price_int
lm1 = lm(Price ~ Year, data=Cars)
plot(Year, Price, main="Sales Price of Car vs. Model Year", xlab="Year",ylab="USD")
abline(lm1,col="red")
summary(lm1)
log_Price = log(Price)
lm2 = lm(log_Price ~ Year, data=Cars)
log_Price = log(Price)
lm2 = lm(log_Price ~ Year, data=Cars)
summary(lm2)
plot(Year,log_Price, main="Sales Price vs. Model Year", ylab="log(USD)",xlab="Year")
log_Year = log(Year)
lm3 = lm(log_Price ~ log_Year,data=Cars)
summary(lm3)
plot(log_Year,log_Price, main="Sales Price vs. Model Year", ylab="log(USD)",xlab="log(Year)")
plot(Year,log_Price, main="Sales Price vs. Model Year", ylab="log(USD)",xlab="Year")
abline(lm2,col="red")
plot(log_Year,log_Price, main="Sales Price vs. Model Year", ylab="log(USD)",xlab="log(Year)")
abline(lm3,col="red")
anscombe = read.table("anscombe.txt",header=TRUE)
#Figure 3.1 on page 46
par(mfrow=c(2,2))
plot(x1,y1,xlim=c(4,20),ylim=c(3,14),main="Data Set 1")
anscombe = read.table("anscombe.txt",header=TRUE)
attach(anscombe)
#Figure 3.1 on page 46
par(mfrow=c(2,2))
plot(x1,y1,xlim=c(4,20),ylim=c(3,14),main="Data Set 1")
abline(lsfit(x1,y1))
plot(x2,y2,xlim=c(4,20),ylim=c(3,14),main="Data Set 2")
abline(lsfit(x2,y2))
plot(x3,y3,xlim=c(4,20),ylim=c(3,14),main="Data Set 3")
abline(lsfit(x3,y3))
plot(x4,y4,xlim=c(4,20),ylim=c(3,14),main="Data Set 4")
abline(lsfit(x4,y4))
#Regression output on page 47
m1 = lm(y1~x1)
summary(m1)
m2 = lm(y2~x2)
summary(m2)
m3 = lm(y3~x3)
summary(m3)
m4 = lm(y4~x4)
summary(m4)
UN11 = read.csv("UN11.csv")
head(UN11)
fertility = UN11$fertility
ppgdp = UN11$ppgdp
plot(ppgdp,fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
UN11$log_fertility = log10(UN11$fertility)
UN11$log_ppgdp = log10(UN11$ppgdp)
plot(UN11$log_ppgdp, UN11$log_fertility, main="Fertility vs. GDP Per Person", xlab="Log(GDP Per Person)", ylab="Log(Total Fertility Rate)")
model_1 = lm(log_fertility ~ log_ppgdp, data=UN11)
abline(model_1, col="red")
summary(model_1)
UN11 = read.csv("UN11.csv")
head(UN11)
fertility = UN11$fertility
ppgdp = UN11$ppgdp
plot(ppgdp,fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
UN11$log_fertility = log(UN11$fertility)
UN11$log_ppgdp = log(UN11$ppgdp)
plot(UN11$log_ppgdp, UN11$log_fertility, main="Fertility vs. GDP Per Person", xlab="Log(GDP Per Person)", ylab="Log(Total Fertility Rate)")
model_1 = lm(log_fertility ~ log_ppgdp, data=UN11)
abline(model_1, col="red")
summary(model_1)
predict(model_1, data.frame(ppgdp = 1000), interval = "prediction")
predict(model_1, data.frame(log_ppgdp = log(1000), interval = "prediction")
predict(model_1, data.frame(log_ppgdp = log(1000)), interval = "prediction")
predict_1000 = predict(model_1, data.frame(log_ppgdp = log(1000)), interval = "prediction")
predict_1000
exp(predict_1000)
#Standardized Residuals
s_resid = rstandard(model_1)
#Fitted values
fitted = fitted(model_1)
plot(fitted,s_resid)
qqnorm(s_resid)
qqline(s_resid,col="red")
#new df of outliers
outliers = which(s_resid < -2 | s_resid > 2)
head(outliers)
#new df of outliers
outliers = which(s_resid < -2 | s_resid > 2)
head(outliers)
#new df of outliers
outliers = UN11[which(s_resid < -2 | s_resid > 2)]
#new df of outliers
index = which(s_resid < -2 | s_resid > 2)
outliers = UN11$country[index]
#new df of outliers
index = which(s_resid < -2 | s_resid > 2)
outliers = UN11$country[index]
#new df of outliers
index = which(s_resid < -2 | s_resid > 2)
outliers = UN11$country[index]
outliers
head(UN11)
head(s_resid)
filter = UN11[1]
filter = UN11[UN11$fertility > 3]
head(s_resid)
outliers = which(s_resid < -2 | s_resid > 2)
outliers = which(s_resid < -2 | s_resid > 2)
head(outliers)
outliers = which(s_resid < -2 | s_resid > 2)
head(UN11[outliers])
outliers = which(s_resid < -2 | s_resid > 2)
head(UN11[outliers, ])
outliers = which(s_resid < -2 | s_resid > 2)
UN11[outliers, ]$country
outliers = which(s_resid < -2 | s_resid > 2)
countries = data.frame(Country = UN11[outliers, ]$country, standardized_residual = s_resid[outliers, ] )
outliers = which(s_resid < -2 | s_resid > 2)
countries = data.frame(Country = UN11[outliers, ]$country, standardized_residual = s_resid[outliers] )
countries
UN11 = read.csv("UN11.csv")
head(UN11)
fertility = UN11$fertility
ppgdp = UN11$ppgdp
plot(ppgdp,fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Person",ylab="Total Fertility Rate")
UN11$log_fertility = log(UN11$fertility)
UN11$log_ppgdp = log(UN11$ppgdp)
plot(UN11$log_ppgdp, UN11$log_fertility, main="Fertility vs. GDP Per Person", xlab="Log(GDP Per Person)", ylab="Log(Total Fertility Rate)")
model_1 = lm(log_fertility ~ log_ppgdp, data=UN11)
abline(model_1, col="red")
summary(model_1)
fertility = UN11$fertility
ppgdp = UN11$ppgdp
plot(ppgdp,fertility,main="Fertility vs. GDP Per Person",xlab="GDP Per Capita",ylab="Total Fertility Rate")
Cars = read.csv("used_cars.csv")
Cars$clean_price <- as.integer(gsub("[\\$,]", "", Cars$price))
head(Cars)
Cars = read.csv("used_cars_updated.csv")
head(Cars)
Year = Cars$model_year
Price = Cars$price_int
lm1 = lm(Price ~ Year, data=Cars)
plot(Year, Price, main="Sales Price of Car vs. Model Year", xlab="Year",ylab="USD")
abline(lm1,col="red")
summary(lm1)
log_Price = log(Price)
lm2 = lm(log_Price ~ Year, data=Cars)
summary(lm2)
plot(Year,log_Price, main="Sales Price vs. Model Year", ylab="log(USD)",xlab="Year")
abline(lm2,col="red")
log_Year = log(Year)
lm3 = lm(log_Price ~ log_Year,data=Cars)
summary(lm3)
plot(log_Year,log_Price, main="Sales Price vs. Model Year", ylab="log(USD)",xlab="log(Year)")
abline(lm3,col="red")
anscombe = read.table("anscombe.txt",header=TRUE)
attach(anscombe)
#Figure 3.1 on page 46
par(mfrow=c(2,2))
plot(x1,y1,xlim=c(4,20),ylim=c(3,14),main="Data Set 1")
abline(lsfit(x1,y1))
plot(x2,y2,xlim=c(4,20),ylim=c(3,14),main="Data Set 2")
abline(lsfit(x2,y2))
plot(x3,y3,xlim=c(4,20),ylim=c(3,14),main="Data Set 3")
abline(lsfit(x3,y3))
plot(x4,y4,xlim=c(4,20),ylim=c(3,14),main="Data Set 4")
abline(lsfit(x4,y4))
#Regression output on page 47
m1 = lm(y1~x1)
summary(m1)
m2 = lm(y2~x2)
summary(m2)
m3 = lm(y3~x3)
summary(m3)
m4 = lm(y4~x4)
summary(m4)
UN11 = read.csv("UN11.csv")
head(UN11)
fertility = UN11$fertility
ppgdp = UN11$ppgdp
plot(ppgdp,fertility,main="Fertility vs. GDP Per Capita",xlab="GDP Per Capita",ylab="Total Fertility Rate")
UN11$log_fertility = log(UN11$fertility)
UN11$log_ppgdp = log(UN11$ppgdp)
plot(UN11$log_ppgdp, UN11$log_fertility, main="Fertility vs. GDP Per Capita", xlab="Log(GDP Per Capita)", ylab="Log(Total Fertility Rate)")
model_1 = lm(log_fertility ~ log_ppgdp, data=UN11)
abline(model_1, col="red")
predict_1000 = predict(model_1, data.frame(log_ppgdp = log(1000)), interval = "prediction")
predict_1000
exp(predict_1000)
s_resid = rstandard(model_1)
fitted = fitted(model_1)
plot(fitted,s_resid)
s_resid = rstandard(model_1)
fitted = fitted(model_1)
plot(fitted,s_resid, ylab="Standardized Residuals", xlab="Fitted Values")
qqnorm
s_resid = rstandard(model_1)
fitted = fitted(model_1)
plot(fitted,s_resid, ylab="Standardized Residuals", xlab="Fitted Values")
qqnorm(s_resid)
outliers = which(s_resid < -2 | s_resid > 2)
countries = data.frame(Country = UN11[outliers, ]$country, standardized_residual = s_resid[outliers] )
countries
